{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host LINUX-WEB-03 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Suspicious Service Install\" on host LINUX-WEB-03 for user svc_okta.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify service name, binPath, start type and signer\",\n    \"Correlate with file creation (Sysmon 11) and registry writes\",\n    \"Check persistence artefacts and scheduled tasks\"\n  ],\n  \"containment\": [\n    \"Stop & disable service; remove binaries\",\n    \"Block hash; isolate host if lateral movement suspected\",\n    \"Snapshot system for forensics\"\n  ],\n  \"remediation\": [\n    \"Baseline approved services; alert on deviations\",\n    \"Enforce AppLocker/WDAC\",\n    \"User awareness for privilege prompts\"\n  ],\n  \"mitre\": [\n    \"T1543\"\n  ],\n  \"spl_query\": \"index=sysmon EventCode=6 | where like(Image,\\\"%sc.exe%\\\") OR like(Image,\\\"%services.exe%\\\") | table _time, host, CommandLine, User\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=svc_okta to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1543 Create/Modify System Process\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host DC-1 for user charlie.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=DC-1 and user=charlie to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Rclone Data Exfiltration\" on host FS-01 for user charlie.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify remote target (cloud provider, bucket, account)\",\n    \"Estimate data volume and sensitivity\",\n    \"Check outbound connections and access tokens used\"\n  ],\n  \"containment\": [\n    \"Revoke exposed API keys/tokens immediately\",\n    \"Block egress for rclone binary and destination endpoints\",\n    \"Notify data owners; legal hold if required\"\n  ],\n  \"remediation\": [\n    \"Implement DLP for cloud egress\",\n    \"Restrict rclone execution; code signing policies\",\n    \"Enable anomaly detection for large transfers\"\n  ],\n  \"mitre\": [\n    \"T1041\"\n  ],\n  \"spl_query\": \"index=sysmon Image=\\\"*rclone*\\\" (CommandLine=\\\"*copy*\\\" OR CommandLine=\\\"*sync*\\\") | stats values(CommandLine) by host user\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=charlie to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1041 Exfiltration\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Rclone Data Exfiltration\" on host DC-1 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify remote target (cloud provider, bucket, account)\",\n    \"Estimate data volume and sensitivity\",\n    \"Check outbound connections and access tokens used\"\n  ],\n  \"containment\": [\n    \"Revoke exposed API keys/tokens immediately\",\n    \"Block egress for rclone binary and destination endpoints\",\n    \"Notify data owners; legal hold if required\"\n  ],\n  \"remediation\": [\n    \"Implement DLP for cloud egress\",\n    \"Restrict rclone execution; code signing policies\",\n    \"Enable anomaly detection for large transfers\"\n  ],\n  \"mitre\": [\n    \"T1041\"\n  ],\n  \"spl_query\": \"index=sysmon Image=\\\"*rclone*\\\" (CommandLine=\\\"*copy*\\\" OR CommandLine=\\\"*sync*\\\") | stats values(CommandLine) by host user\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=DC-1 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1041 Exfiltration\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Suspicious Service Install\" on host WIN10-22H2-07 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify service name, binPath, start type and signer\",\n    \"Correlate with file creation (Sysmon 11) and registry writes\",\n    \"Check persistence artefacts and scheduled tasks\"\n  ],\n  \"containment\": [\n    \"Stop & disable service; remove binaries\",\n    \"Block hash; isolate host if lateral movement suspected\",\n    \"Snapshot system for forensics\"\n  ],\n  \"remediation\": [\n    \"Baseline approved services; alert on deviations\",\n    \"Enforce AppLocker/WDAC\",\n    \"User awareness for privilege prompts\"\n  ],\n  \"mitre\": [\n    \"T1543\"\n  ],\n  \"spl_query\": \"index=sysmon EventCode=6 | where like(Image,\\\"%sc.exe%\\\") OR like(Image,\\\"%services.exe%\\\") | table _time, host, CommandLine, User\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1543 Create/Modify System Process\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host SQL-PRD-02 for user alice.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=SQL-PRD-02 and user=alice to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host FS-01 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Rclone Data Exfiltration\" on host FS-01 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify remote target (cloud provider, bucket, account)\",\n    \"Estimate data volume and sensitivity\",\n    \"Check outbound connections and access tokens used\"\n  ],\n  \"containment\": [\n    \"Revoke exposed API keys/tokens immediately\",\n    \"Block egress for rclone binary and destination endpoints\",\n    \"Notify data owners; legal hold if required\"\n  ],\n  \"remediation\": [\n    \"Implement DLP for cloud egress\",\n    \"Restrict rclone execution; code signing policies\",\n    \"Enable anomaly detection for large transfers\"\n  ],\n  \"mitre\": [\n    \"T1041\"\n  ],\n  \"spl_query\": \"index=sysmon Image=\\\"*rclone*\\\" (CommandLine=\\\"*copy*\\\" OR CommandLine=\\\"*sync*\\\") | stats values(CommandLine) by host user\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1041 Exfiltration\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Excessive Failed Logins (Windows 4625)\" on host FS-01 for user svc_okta.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Confirm time window and spike of EventCode 4625 by user and src_ip\",\n    \"Correlate with EventCode 4624 (successful logon) after failures\",\n    \"Check VPN/IdP logs for the same src_ip or ASN reputation\"\n  ],\n  \"containment\": [\n    \"Temporarily lock the account and force MFA reset\",\n    \"Block malicious src_ip at edge/WAF if external\",\n    \"Notify user and SOC; open an IR ticket\"\n  ],\n  \"remediation\": [\n    \"Enable smart lockout; enforce password rotation\",\n    \"Enable phishing-resistant MFA\",\n    \"Tune detection thresholds per user baseline\"\n  ],\n  \"mitre\": [\n    \"T1110\"\n  ],\n  \"spl_query\": \"index=winsec sourcetype=WinEventLog:Security EventCode=4625 | bin _time span=5m | stats count by _time, Account_Name, src_ip | where count>20\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=svc_okta to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1110 Brute Force\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Excessive Failed Logins (Windows 4625)\" on host SQL-PRD-02 for user bob.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Confirm time window and spike of EventCode 4625 by user and src_ip\",\n    \"Correlate with EventCode 4624 (successful logon) after failures\",\n    \"Check VPN/IdP logs for the same src_ip or ASN reputation\"\n  ],\n  \"containment\": [\n    \"Temporarily lock the account and force MFA reset\",\n    \"Block malicious src_ip at edge/WAF if external\",\n    \"Notify user and SOC; open an IR ticket\"\n  ],\n  \"remediation\": [\n    \"Enable smart lockout; enforce password rotation\",\n    \"Enable phishing-resistant MFA\",\n    \"Tune detection thresholds per user baseline\"\n  ],\n  \"mitre\": [\n    \"T1110\"\n  ],\n  \"spl_query\": \"index=winsec sourcetype=WinEventLog:Security EventCode=4625 | bin _time span=5m | stats count by _time, Account_Name, src_ip | where count>20\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=SQL-PRD-02 and user=bob to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1110 Brute Force\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"PowerShell EncodedCommand\" on host FS-01 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Decode the Base64 payload and inspect for IOCs\",\n    \"Review parent process, user context and execution path\",\n    \"Hunt for related network connections and file writes\"\n  ],\n  \"containment\": [\n    \"Terminate process; isolate host if C2 suspected\",\n    \"Block hash/path; enable AMSI and CLM\",\n    \"Collect artifacts (Sysmon 1/3/11) for scope\"\n  ],\n  \"remediation\": [\n    \"Restrict PowerShell to Constrained Language Mode for non-admins\",\n    \"Harden script signing; block download cradles\",\n    \"Add detections for suspicious flags (-enc, -nop, -w hidden)\"\n  ],\n  \"mitre\": [\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"index=sysmon (Image=\\\"*powershell.exe*\\\" AND (CommandLine=\\\"*-enc *\\\" OR CommandLine=\\\"*-EncodedCommand *\\\")) | table _time, host, user, CommandLine\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1059.001 PowerShell\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host LINUX-WEB-03 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host FS-01 for user bob.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=bob to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host WIN10-22H2-07 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host LINUX-WEB-03 for user svc_okta.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=svc_okta to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Excessive Failed Logins (Windows 4625)\" on host WIN10-22H2-07 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Confirm time window and spike of EventCode 4625 by user and src_ip\",\n    \"Correlate with EventCode 4624 (successful logon) after failures\",\n    \"Check VPN/IdP logs for the same src_ip or ASN reputation\"\n  ],\n  \"containment\": [\n    \"Temporarily lock the account and force MFA reset\",\n    \"Block malicious src_ip at edge/WAF if external\",\n    \"Notify user and SOC; open an IR ticket\"\n  ],\n  \"remediation\": [\n    \"Enable smart lockout; enforce password rotation\",\n    \"Enable phishing-resistant MFA\",\n    \"Tune detection thresholds per user baseline\"\n  ],\n  \"mitre\": [\n    \"T1110\"\n  ],\n  \"spl_query\": \"index=winsec sourcetype=WinEventLog:Security EventCode=4625 | bin _time span=5m | stats count by _time, Account_Name, src_ip | where count>20\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1110 Brute Force\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host LINUX-WEB-03 for user alice.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=alice to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host WIN10-22H2-07 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"PowerShell EncodedCommand\" on host DC-1 for user alice.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Decode the Base64 payload and inspect for IOCs\",\n    \"Review parent process, user context and execution path\",\n    \"Hunt for related network connections and file writes\"\n  ],\n  \"containment\": [\n    \"Terminate process; isolate host if C2 suspected\",\n    \"Block hash/path; enable AMSI and CLM\",\n    \"Collect artifacts (Sysmon 1/3/11) for scope\"\n  ],\n  \"remediation\": [\n    \"Restrict PowerShell to Constrained Language Mode for non-admins\",\n    \"Harden script signing; block download cradles\",\n    \"Add detections for suspicious flags (-enc, -nop, -w hidden)\"\n  ],\n  \"mitre\": [\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"index=sysmon (Image=\\\"*powershell.exe*\\\" AND (CommandLine=\\\"*-enc *\\\" OR CommandLine=\\\"*-EncodedCommand *\\\")) | table _time, host, user, CommandLine\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=DC-1 and user=alice to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1059.001 PowerShell\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Suspicious Service Install\" on host DC-1 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify service name, binPath, start type and signer\",\n    \"Correlate with file creation (Sysmon 11) and registry writes\",\n    \"Check persistence artefacts and scheduled tasks\"\n  ],\n  \"containment\": [\n    \"Stop & disable service; remove binaries\",\n    \"Block hash; isolate host if lateral movement suspected\",\n    \"Snapshot system for forensics\"\n  ],\n  \"remediation\": [\n    \"Baseline approved services; alert on deviations\",\n    \"Enforce AppLocker/WDAC\",\n    \"User awareness for privilege prompts\"\n  ],\n  \"mitre\": [\n    \"T1543\"\n  ],\n  \"spl_query\": \"index=sysmon EventCode=6 | where like(Image,\\\"%sc.exe%\\\") OR like(Image,\\\"%services.exe%\\\") | table _time, host, CommandLine, User\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=DC-1 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1543 Create/Modify System Process\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host LINUX-WEB-03 for user charlie.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=charlie to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Excessive Failed Logins (Windows 4625)\" on host LINUX-WEB-03 for user charlie.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Confirm time window and spike of EventCode 4625 by user and src_ip\",\n    \"Correlate with EventCode 4624 (successful logon) after failures\",\n    \"Check VPN/IdP logs for the same src_ip or ASN reputation\"\n  ],\n  \"containment\": [\n    \"Temporarily lock the account and force MFA reset\",\n    \"Block malicious src_ip at edge/WAF if external\",\n    \"Notify user and SOC; open an IR ticket\"\n  ],\n  \"remediation\": [\n    \"Enable smart lockout; enforce password rotation\",\n    \"Enable phishing-resistant MFA\",\n    \"Tune detection thresholds per user baseline\"\n  ],\n  \"mitre\": [\n    \"T1110\"\n  ],\n  \"spl_query\": \"index=winsec sourcetype=WinEventLog:Security EventCode=4625 | bin _time span=5m | stats count by _time, Account_Name, src_ip | where count>20\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=charlie to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1110 Brute Force\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Rclone Data Exfiltration\" on host LINUX-WEB-03 for user bob.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify remote target (cloud provider, bucket, account)\",\n    \"Estimate data volume and sensitivity\",\n    \"Check outbound connections and access tokens used\"\n  ],\n  \"containment\": [\n    \"Revoke exposed API keys/tokens immediately\",\n    \"Block egress for rclone binary and destination endpoints\",\n    \"Notify data owners; legal hold if required\"\n  ],\n  \"remediation\": [\n    \"Implement DLP for cloud egress\",\n    \"Restrict rclone execution; code signing policies\",\n    \"Enable anomaly detection for large transfers\"\n  ],\n  \"mitre\": [\n    \"T1041\"\n  ],\n  \"spl_query\": \"index=sysmon Image=\\\"*rclone*\\\" (CommandLine=\\\"*copy*\\\" OR CommandLine=\\\"*sync*\\\") | stats values(CommandLine) by host user\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=bob to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1041 Exfiltration\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host WIN10-22H2-07 for user svc_okta.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=svc_okta to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host FS-01 for user bob.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=bob to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host DC-1 for user svc_okta.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=DC-1 and user=svc_okta to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host LINUX-WEB-03 for user bob.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=bob to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host WIN10-22H2-07 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Rclone Data Exfiltration\" on host LINUX-WEB-03 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify remote target (cloud provider, bucket, account)\",\n    \"Estimate data volume and sensitivity\",\n    \"Check outbound connections and access tokens used\"\n  ],\n  \"containment\": [\n    \"Revoke exposed API keys/tokens immediately\",\n    \"Block egress for rclone binary and destination endpoints\",\n    \"Notify data owners; legal hold if required\"\n  ],\n  \"remediation\": [\n    \"Implement DLP for cloud egress\",\n    \"Restrict rclone execution; code signing policies\",\n    \"Enable anomaly detection for large transfers\"\n  ],\n  \"mitre\": [\n    \"T1041\"\n  ],\n  \"spl_query\": \"index=sysmon Image=\\\"*rclone*\\\" (CommandLine=\\\"*copy*\\\" OR CommandLine=\\\"*sync*\\\") | stats values(CommandLine) by host user\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1041 Exfiltration\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Excessive Failed Logins (Windows 4625)\" on host LINUX-WEB-03 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Confirm time window and spike of EventCode 4625 by user and src_ip\",\n    \"Correlate with EventCode 4624 (successful logon) after failures\",\n    \"Check VPN/IdP logs for the same src_ip or ASN reputation\"\n  ],\n  \"containment\": [\n    \"Temporarily lock the account and force MFA reset\",\n    \"Block malicious src_ip at edge/WAF if external\",\n    \"Notify user and SOC; open an IR ticket\"\n  ],\n  \"remediation\": [\n    \"Enable smart lockout; enforce password rotation\",\n    \"Enable phishing-resistant MFA\",\n    \"Tune detection thresholds per user baseline\"\n  ],\n  \"mitre\": [\n    \"T1110\"\n  ],\n  \"spl_query\": \"index=winsec sourcetype=WinEventLog:Security EventCode=4625 | bin _time span=5m | stats count by _time, Account_Name, src_ip | where count>20\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1110 Brute Force\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host FS-01 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host LINUX-WEB-03 for user dba_prod.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=LINUX-WEB-03 and user=dba_prod to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Suspicious Service Install\" on host FS-01 for user alice.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify service name, binPath, start type and signer\",\n    \"Correlate with file creation (Sysmon 11) and registry writes\",\n    \"Check persistence artefacts and scheduled tasks\"\n  ],\n  \"containment\": [\n    \"Stop & disable service; remove binaries\",\n    \"Block hash; isolate host if lateral movement suspected\",\n    \"Snapshot system for forensics\"\n  ],\n  \"remediation\": [\n    \"Baseline approved services; alert on deviations\",\n    \"Enforce AppLocker/WDAC\",\n    \"User awareness for privilege prompts\"\n  ],\n  \"mitre\": [\n    \"T1543\"\n  ],\n  \"spl_query\": \"index=sysmon EventCode=6 | where like(Image,\\\"%sc.exe%\\\") OR like(Image,\\\"%services.exe%\\\") | table _time, host, CommandLine, User\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=alice to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1543 Create/Modify System Process\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"DNS Tunneling\" on host DC-1 for user alice.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Inspect domains with long or high-entropy subdomains\",\n    \"Correlate with host processes and destinations\",\n    \"Check for TXT record bursts and unusual NXDOMAIN rates\"\n  ],\n  \"containment\": [\n    \"Block suspicious domains at DNS resolver\",\n    \"Isolate host if active exfiltration suspected\",\n    \"Capture PCAP for confirmation\"\n  ],\n  \"remediation\": [\n    \"Enable DNS egress filtering; alert on entropy/volume anomalies\",\n    \"Deploy DoH policy and logging\",\n    \"User awareness for malware infection vectors\"\n  ],\n  \"mitre\": [\n    \"T1071.004\"\n  ],\n  \"spl_query\": \"index=dns answer IN (\\\"*\\\") query IN (\\\"*.xyz\\\",\\\"*.info\\\") | stats avg(len(query)) as qlen, count by src_ip | where qlen>50 AND count>500\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=DC-1 and user=alice to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1071.004 DNS\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"PowerShell EncodedCommand\" on host FS-01 for user alice.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Decode the Base64 payload and inspect for IOCs\",\n    \"Review parent process, user context and execution path\",\n    \"Hunt for related network connections and file writes\"\n  ],\n  \"containment\": [\n    \"Terminate process; isolate host if C2 suspected\",\n    \"Block hash/path; enable AMSI and CLM\",\n    \"Collect artifacts (Sysmon 1/3/11) for scope\"\n  ],\n  \"remediation\": [\n    \"Restrict PowerShell to Constrained Language Mode for non-admins\",\n    \"Harden script signing; block download cradles\",\n    \"Add detections for suspicious flags (-enc, -nop, -w hidden)\"\n  ],\n  \"mitre\": [\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"index=sysmon (Image=\\\"*powershell.exe*\\\" AND (CommandLine=\\\"*-enc *\\\" OR CommandLine=\\\"*-EncodedCommand *\\\")) | table _time, host, user, CommandLine\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=FS-01 and user=alice to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1059.001 PowerShell\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"PowerShell EncodedCommand\" on host SQL-PRD-02 for user svc_okta.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Decode the Base64 payload and inspect for IOCs\",\n    \"Review parent process, user context and execution path\",\n    \"Hunt for related network connections and file writes\"\n  ],\n  \"containment\": [\n    \"Terminate process; isolate host if C2 suspected\",\n    \"Block hash/path; enable AMSI and CLM\",\n    \"Collect artifacts (Sysmon 1/3/11) for scope\"\n  ],\n  \"remediation\": [\n    \"Restrict PowerShell to Constrained Language Mode for non-admins\",\n    \"Harden script signing; block download cradles\",\n    \"Add detections for suspicious flags (-enc, -nop, -w hidden)\"\n  ],\n  \"mitre\": [\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"index=sysmon (Image=\\\"*powershell.exe*\\\" AND (CommandLine=\\\"*-enc *\\\" OR CommandLine=\\\"*-EncodedCommand *\\\")) | table _time, host, user, CommandLine\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=SQL-PRD-02 and user=svc_okta to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1059.001 PowerShell\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Suspicious Service Install\" on host WIN10-22H2-07 for user svc_okta.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify service name, binPath, start type and signer\",\n    \"Correlate with file creation (Sysmon 11) and registry writes\",\n    \"Check persistence artefacts and scheduled tasks\"\n  ],\n  \"containment\": [\n    \"Stop & disable service; remove binaries\",\n    \"Block hash; isolate host if lateral movement suspected\",\n    \"Snapshot system for forensics\"\n  ],\n  \"remediation\": [\n    \"Baseline approved services; alert on deviations\",\n    \"Enforce AppLocker/WDAC\",\n    \"User awareness for privilege prompts\"\n  ],\n  \"mitre\": [\n    \"T1543\"\n  ],\n  \"spl_query\": \"index=sysmon EventCode=6 | where like(Image,\\\"%sc.exe%\\\") OR like(Image,\\\"%services.exe%\\\") | table _time, host, CommandLine, User\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=svc_okta to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1543 Create/Modify System Process\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"PowerShell EncodedCommand\" on host SQL-PRD-02 for user charlie.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Decode the Base64 payload and inspect for IOCs\",\n    \"Review parent process, user context and execution path\",\n    \"Hunt for related network connections and file writes\"\n  ],\n  \"containment\": [\n    \"Terminate process; isolate host if C2 suspected\",\n    \"Block hash/path; enable AMSI and CLM\",\n    \"Collect artifacts (Sysmon 1/3/11) for scope\"\n  ],\n  \"remediation\": [\n    \"Restrict PowerShell to Constrained Language Mode for non-admins\",\n    \"Harden script signing; block download cradles\",\n    \"Add detections for suspicious flags (-enc, -nop, -w hidden)\"\n  ],\n  \"mitre\": [\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"index=sysmon (Image=\\\"*powershell.exe*\\\" AND (CommandLine=\\\"*-enc *\\\" OR CommandLine=\\\"*-EncodedCommand *\\\")) | table _time, host, user, CommandLine\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=SQL-PRD-02 and user=charlie to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1059.001 PowerShell\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot. A Splunk notable fired: \"Kerberoasting Activity\" on host WIN10-22H2-07 for user svc_backup.\nReturn a JSON object with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[].", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify accounts with unusually high service ticket requests\",\n    \"Check encryption type (RC4 vs AES) and target SPNs\",\n    \"Correlate with tools (hashcat usage traces, unusual process)\"\n  ],\n  \"containment\": [\n    \"Temporarily disable targeted service accounts\",\n    \"Rotate keys to AES-only; enforce long random passwords\",\n    \"Increase monitoring on DCs for 4769 patterns\"\n  ],\n  \"remediation\": [\n    \"Migrate SPNs to AES; disable RC4 where possible\",\n    \"Limit service account privileges; managed service accounts\",\n    \"Implement honey SPNs for early warning\"\n  ],\n  \"mitre\": [\n    \"T1558.003\"\n  ],\n  \"spl_query\": \"index=winsec EventCode=4769 Service_Name!=\\\"krbtgt\\\" Ticket_Encryption_Type=0x17 OR Ticket_Encryption_Type=0x12 | stats count by Account_Name, Service_Name\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Run the provided SPL in a 24h window and confirm hits\",\n    \"Pivot on host=WIN10-22H2-07 and user=svc_backup to scope impact\",\n    \"Document results in case ticket and attach artifacts\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1558.003 Kerberoasting\"\n  ]\n}", "metadata": {"domain": "SecOps/Splunk", "created_at": "2025-08-23T00:40:50Z", "tags": ["splunk", "playbook", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on DC-1 for alice.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on SQL-PRD-02 for charlie.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on WIN10-22H2-07 for bob.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on LINUX-WEB-03 for charlie.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on DC-1 for bob.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on SQL-PRD-02 for svc_backup.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on SQL-PRD-02 for svc_okta.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on DC-1 for bob.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on FS-01 for svc_backup.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on DC-1 for svc_okta.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on DC-1 for dba_prod.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on LINUX-WEB-03 for dba_prod.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on FS-01 for alice.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on LINUX-WEB-03 for svc_okta.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on SQL-PRD-02 for charlie.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on FS-01 for svc_backup.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on DC-1 for charlie.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on LINUX-WEB-03 for svc_backup.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on SQL-PRD-02 for bob.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on FS-01 for dba_prod.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on SQL-PRD-02 for dba_prod.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on SQL-PRD-02 for dba_prod.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on FS-01 for alice.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on SQL-PRD-02 for svc_okta.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Run Key Persistence\" (signal: registry_persistence_runkey) on SQL-PRD-02 for bob.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Extract autorun value data and referenced binary\",\n    \"Correlate with file creation and signer info\",\n    \"Check Autoruns and Scheduled Tasks for overlap\"\n  ],\n  \"containment\": [\n    \"Delete autorun value; remove malicious file\",\n    \"Block hash; user awareness training\",\n    \"Monitor for new Run key entries\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1060\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/REGISTRY_WRITE where path like \\\"HKCU\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersion\\\\\\\\Run\\\\\\\\%\\\" and NOT value_data endswith \\\".lnk\\\" within 10m by user host\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1060\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on LINUX-WEB-03 for svc_okta.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on DC-1 for dba_prod.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on WIN10-22H2-07 for dba_prod.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"Office  PowerShell Child\" (signal: office_child_proc) on FS-01 for alice.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Collect full command line and macro/VBA indicators\",\n    \"Hash lookup and reputation check\",\n    \"Review network connections from child process\"\n  ],\n  \"containment\": [\n    \"Isolate host; block Office macro from internet-origin files\",\n    \"Remove malicious templates; educate user\",\n    \"Add block rule for suspicious parent-child chains\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1204.002\",\n    \"T1059.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/NEW_PROCESS where parent.image in [\\\"winword.exe\\\",\\\"excel.exe\\\",\\\"powerpnt.exe\\\"] and image endswith \\\"powershell.exe\\\" and (cmdline contains \\\"-enc\\\" or cmdline contains \\\"DownloadString\\\") within 5m by host user\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1204.002,T1059.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "You are a SecOps copilot using LimaCharlie. Detection fired: \"LSASS Memory Access\" (signal: lsass_sus_access) on DC-1 for charlie.\nReturn JSON with keys: triage_steps[], containment[], remediation[], mitre[], spl_query, lc_rule, k8s_manifest, validation_steps[], citations[]. Include an improved lc_rule.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify tool used (procdump/comsvcs/mimikatz)\",\n    \"Check PPL bypass indicators and driver tampering\",\n    \"Scope lateral movement from the same user\"\n  ],\n  \"containment\": [\n    \"Enable LSA protection (RunAsPPL)\",\n    \"Block unsigned drivers; isolate host if creds at risk\",\n    \"Rotate high value credentials; clear cached tickets\"\n  ],\n  \"remediation\": [\n    \"Harden baseline controls (PPL, macro policy, WDAC/AppLocker)\",\n    \"Add EDR alerting for repeated attempts\",\n    \"Improve detections with parent/child and frequency constraints\"\n  ],\n  \"mitre\": [\n    \"T1003.001\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"event/PROC_ACCESS where target.image endswith \\\"lsass.exe\\\" and access.mask contains \\\"PROCESS_VM_READ\\\" and NOT process.signed == \\\"Signed\\\" | group by host user file.hash within 1m\",\n  \"k8s_manifest\": \"\",\n  \"validation_steps\": [\n    \"Verify detection fidelity by replaying similar benign events\",\n    \"Confirm containment steps completed and no re-triggering\",\n    \"Document improved rule and deploy to test fleet before prod\"\n  ],\n  \"citations\": [\n    \"MITRE ATT&CK T1003.001\"\n  ]\n}", "metadata": {"domain": "SecOps/LimaCharlie", "created_at": "2025-08-23T00:40:50Z", "tags": ["limacharlie", "detection", "mitre"], "difficulty": "intermediate", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Default-deny + allow DNS egress only. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"List existing NetworkPolicies and traffic expectations\",\n    \"Identify Pods failing to resolve DNS after apply\",\n    \"Check kube-dns ClusterIP and correct port/protocol\"\n  ],\n  \"containment\": [\n    \"Temporarily allow egress to required services\",\n    \"Iteratively tighten rules with tests\",\n    \"Document exceptions\"\n  ],\n  \"remediation\": [\n    \"Adopt policy-as-code with reviews\",\n    \"Maintain service maps and required egress list\",\n    \"Add deny-all baseline in each namespace\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: networking.k8s.io/v1\\nkind: NetworkPolicy\\nmetadata:\\n  name: default-deny-all\\nspec:\\n  podSelector: {}\\n  policyTypes: [\\\"Ingress\\\",\\\"Egress\\\"]\\n  egress:\\n  - to:\\n    - namespaceSelector: {matchLabels: {kubernetes.io/metadata.name: kube-system}}\\n    ports:\\n    - protocol: UDP\\n      port: 53\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"K8s NetworkPolicy\",\n    \"NSA/CISA Kubernetes Hardening\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Default-deny + allow DNS egress only. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"List existing NetworkPolicies and traffic expectations\",\n    \"Identify Pods failing to resolve DNS after apply\",\n    \"Check kube-dns ClusterIP and correct port/protocol\"\n  ],\n  \"containment\": [\n    \"Temporarily allow egress to required services\",\n    \"Iteratively tighten rules with tests\",\n    \"Document exceptions\"\n  ],\n  \"remediation\": [\n    \"Adopt policy-as-code with reviews\",\n    \"Maintain service maps and required egress list\",\n    \"Add deny-all baseline in each namespace\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: networking.k8s.io/v1\\nkind: NetworkPolicy\\nmetadata:\\n  name: default-deny-all\\nspec:\\n  podSelector: {}\\n  policyTypes: [\\\"Ingress\\\",\\\"Egress\\\"]\\n  egress:\\n  - to:\\n    - namespaceSelector: {matchLabels: {kubernetes.io/metadata.name: kube-system}}\\n    ports:\\n    - protocol: UDP\\n      port: 53\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"K8s NetworkPolicy\",\n    \"NSA/CISA Kubernetes Hardening\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Default-deny + allow DNS egress only. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"List existing NetworkPolicies and traffic expectations\",\n    \"Identify Pods failing to resolve DNS after apply\",\n    \"Check kube-dns ClusterIP and correct port/protocol\"\n  ],\n  \"containment\": [\n    \"Temporarily allow egress to required services\",\n    \"Iteratively tighten rules with tests\",\n    \"Document exceptions\"\n  ],\n  \"remediation\": [\n    \"Adopt policy-as-code with reviews\",\n    \"Maintain service maps and required egress list\",\n    \"Add deny-all baseline in each namespace\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: networking.k8s.io/v1\\nkind: NetworkPolicy\\nmetadata:\\n  name: default-deny-all\\nspec:\\n  podSelector: {}\\n  policyTypes: [\\\"Ingress\\\",\\\"Egress\\\"]\\n  egress:\\n  - to:\\n    - namespaceSelector: {matchLabels: {kubernetes.io/metadata.name: kube-system}}\\n    ports:\\n    - protocol: UDP\\n      port: 53\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"K8s NetworkPolicy\",\n    \"NSA/CISA Kubernetes Hardening\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Default-deny + allow DNS egress only. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"List existing NetworkPolicies and traffic expectations\",\n    \"Identify Pods failing to resolve DNS after apply\",\n    \"Check kube-dns ClusterIP and correct port/protocol\"\n  ],\n  \"containment\": [\n    \"Temporarily allow egress to required services\",\n    \"Iteratively tighten rules with tests\",\n    \"Document exceptions\"\n  ],\n  \"remediation\": [\n    \"Adopt policy-as-code with reviews\",\n    \"Maintain service maps and required egress list\",\n    \"Add deny-all baseline in each namespace\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: networking.k8s.io/v1\\nkind: NetworkPolicy\\nmetadata:\\n  name: default-deny-all\\nspec:\\n  podSelector: {}\\n  policyTypes: [\\\"Ingress\\\",\\\"Egress\\\"]\\n  egress:\\n  - to:\\n    - namespaceSelector: {matchLabels: {kubernetes.io/metadata.name: kube-system}}\\n    ports:\\n    - protocol: UDP\\n      port: 53\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"K8s NetworkPolicy\",\n    \"NSA/CISA Kubernetes Hardening\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Default-deny + allow DNS egress only. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"List existing NetworkPolicies and traffic expectations\",\n    \"Identify Pods failing to resolve DNS after apply\",\n    \"Check kube-dns ClusterIP and correct port/protocol\"\n  ],\n  \"containment\": [\n    \"Temporarily allow egress to required services\",\n    \"Iteratively tighten rules with tests\",\n    \"Document exceptions\"\n  ],\n  \"remediation\": [\n    \"Adopt policy-as-code with reviews\",\n    \"Maintain service maps and required egress list\",\n    \"Add deny-all baseline in each namespace\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: networking.k8s.io/v1\\nkind: NetworkPolicy\\nmetadata:\\n  name: default-deny-all\\nspec:\\n  podSelector: {}\\n  policyTypes: [\\\"Ingress\\\",\\\"Egress\\\"]\\n  egress:\\n  - to:\\n    - namespaceSelector: {matchLabels: {kubernetes.io/metadata.name: kube-system}}\\n    ports:\\n    - protocol: UDP\\n      port: 53\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"K8s NetworkPolicy\",\n    \"NSA/CISA Kubernetes Hardening\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Default-deny + allow DNS egress only. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"List existing NetworkPolicies and traffic expectations\",\n    \"Identify Pods failing to resolve DNS after apply\",\n    \"Check kube-dns ClusterIP and correct port/protocol\"\n  ],\n  \"containment\": [\n    \"Temporarily allow egress to required services\",\n    \"Iteratively tighten rules with tests\",\n    \"Document exceptions\"\n  ],\n  \"remediation\": [\n    \"Adopt policy-as-code with reviews\",\n    \"Maintain service maps and required egress list\",\n    \"Add deny-all baseline in each namespace\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: networking.k8s.io/v1\\nkind: NetworkPolicy\\nmetadata:\\n  name: default-deny-all\\nspec:\\n  podSelector: {}\\n  policyTypes: [\\\"Ingress\\\",\\\"Egress\\\"]\\n  egress:\\n  - to:\\n    - namespaceSelector: {matchLabels: {kubernetes.io/metadata.name: kube-system}}\\n    ports:\\n    - protocol: UDP\\n      port: 53\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"K8s NetworkPolicy\",\n    \"NSA/CISA Kubernetes Hardening\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Default-deny + allow DNS egress only. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"List existing NetworkPolicies and traffic expectations\",\n    \"Identify Pods failing to resolve DNS after apply\",\n    \"Check kube-dns ClusterIP and correct port/protocol\"\n  ],\n  \"containment\": [\n    \"Temporarily allow egress to required services\",\n    \"Iteratively tighten rules with tests\",\n    \"Document exceptions\"\n  ],\n  \"remediation\": [\n    \"Adopt policy-as-code with reviews\",\n    \"Maintain service maps and required egress list\",\n    \"Add deny-all baseline in each namespace\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: networking.k8s.io/v1\\nkind: NetworkPolicy\\nmetadata:\\n  name: default-deny-all\\nspec:\\n  podSelector: {}\\n  policyTypes: [\\\"Ingress\\\",\\\"Egress\\\"]\\n  egress:\\n  - to:\\n    - namespaceSelector: {matchLabels: {kubernetes.io/metadata.name: kube-system}}\\n    ports:\\n    - protocol: UDP\\n      port: 53\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"K8s NetworkPolicy\",\n    \"NSA/CISA Kubernetes Hardening\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Image signature verification at admission. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify unsigned image deployments failing at admission\",\n    \"Check cosign public key distribution\",\n    \"Review CI logs for signature and SBOM steps\"\n  ],\n  \"containment\": [\n    \"Block unsigned images in all namespaces\",\n    \"Rollback to last signed digest\",\n    \"Quarantine workloads from untrusted registries\"\n  ],\n  \"remediation\": [\n    \"Integrate cosign signing in CI/CD\",\n    \"Store attestations and verify on deploy\",\n    \"Pin images by digest; forbid :latest with policy\"\n  ],\n  \"mitre\": [],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: kyverno.io/v1\\nkind: ClusterPolicy\\nmetadata:\\n  name: verify-images\\nspec:\\n  rules:\\n  - name: verify\\n    match: {resources: {kinds: [\\\"Pod\\\",\\\"Deployment\\\"]}}\\n    verifyImages:\\n    - image: \\\"ghcr.io/example/*\\\"\\n      attestors:\\n      - entries:\\n        - keys: {publicKeys: [\\\"-----BEGIN PUBLIC KEY-----...\\\"]}\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"Sigstore Cosign\",\n    \"SLSA provenance\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
{"instruction": "Harden Pod to PSA restricted. Return JSON with the specified keys.", "input": "", "output": "{\n  \"triage_steps\": [\n    \"Identify insecure fields (privileged, hostPID, :latest tag, no seccomp)\",\n    \"Review namespace PSA labels enforce=restricted\",\n    \"Check admission controller rejections\"\n  ],\n  \"containment\": [\n    \"Delete non-compliant Pods\",\n    \"Apply secure manifest with non-root and seccomp\",\n    \"Label namespaces with PSA enforce=restricted\"\n  ],\n  \"remediation\": [\n    \"Add Kyverno policy to deny privileged/hostPID\",\n    \"Pin images by digest and verify signatures\",\n    \"Enable readOnlyRootFilesystem across workloads\"\n  ],\n  \"mitre\": [\n    \"T1611\"\n  ],\n  \"spl_query\": \"\",\n  \"lc_rule\": \"\",\n  \"k8s_manifest\": \"apiVersion: v1\\nkind: Pod\\nmetadata:\\n  name: secure-app\\n  labels: {app: secure-app}\\nspec:\\n  securityContext:\\n    runAsNonRoot: true\\n    seccompProfile: {type: RuntimeDefault}\\n  containers:\\n  - name: app\\n    image: ghcr.io/example/app@sha256:deadbeef\\n    securityContext:\\n      allowPrivilegeEscalation: false\\n      readOnlyRootFilesystem: true\\n      capabilities: {drop: [\\\"ALL\\\"]}\\n      runAsUser: 1000\",\n  \"validation_steps\": [\n    \"kubectl apply -f <manifest>.yaml and verify admission outcome\",\n    \"kubectl get pods -A -o jsonpath to confirm securityContext fields\",\n    \"Run a test Pod to validate connectivity/policy behavior\"\n  ],\n  \"citations\": [\n    \"PSA Restricted\",\n    \"MITRE ATT&CK T1611\"\n  ]\n}", "metadata": {"domain": "Kubernetes", "created_at": "2025-08-23T00:40:50Z", "tags": ["k8s", "hardening", "policy"], "difficulty": "advanced", "source": "synthetic"}}
