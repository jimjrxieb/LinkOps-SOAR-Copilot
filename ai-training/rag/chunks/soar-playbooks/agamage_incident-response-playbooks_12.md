# Incident Response Playbook

**Incident Type**: General Incident
**Framework**: NIST

**Playbook Content**:
<s>[INST] <<SYS>>
You are a highly advanced AI assistant in our company responsible for generating detailed incident response playbooks for various types of cyber attacks in OT environment.Please generate a comprehensive incident response playbook for given attacks, adhering to the NIST Special Publication 800-61 Revision 2 guidelines for computer security incident handling.The playbook must adhere to the NIST incident response lifecycle stages - Preparation, Detection and Analysis, Containment, Eradication, Recovery, and Lessons Learned.Each step should describe and elaborate in detail with key practical information to follow in response to a incident
<</SYS>>

Please provide a incident response playbook for Handling Suspicious Network Activity? [/INST] Sure. Here is the information requested.
Title: : Incident Response Playbook for Handling Suspicious Network Activity
1. Preparation: : Objective: Establish Contacts, Define Procedures, Gather Information to Save Time During an Incident
Objective: Establish contacts, define procedures, gather information to save time during an incident.
Intrusion Detection Systems (EDR, NIPS, IPS):
Ensure monitoring tools are up-to-date.
Establish contacts with network and security operation teams.
Define and communicate the alert notification process to all relevant parties.
Verify access to devices and their ability to monitor concerned perimeters.
Ensure capability to isolate endpoints and areas using EDR or Firewall.
Network:
Maintain an up-to-date inventory of network access points, ensuring accessibility and versioning.
Ensure network teams have current network maps and configurations, highlighting concerned zones and operational teams.
Regularly check for and close any unwanted network access points.
Monitor VPN and Cloud access, especially from rare locations.
Deploy and monitor traffic management tools.
Baseline Traffic:
Identify baseline traffic and critical business flows.
Ensure personnel are familiar with the tools and know how to use them effectively.
Keep logs operational and retain them for more than six months.
2. Detection and Analysis: : Objective: Detect the incident, determine its scope, and involve the appropriate parties.
Sources of Detection:
Notification by users or helpdesk.
IDS/IPS/NIDS/EDR logs, alerts, and reports.
Detection by network staff.
Firewall and proxy logs.
Complaints from external sources.
Honeypots or other deceptive solutions.
Record Suspicious Network Activity:
Store network frames into a file and transmit to the incident response team for analysis.
Use network capture tools (tshark, windump, tcpdump) to capture malicious traffic.
Use a hub or port mirroring on an affected LAN to collect valuable data.
Engage the incident response team for assistance with network forensics.
Analyze the Attack:
Analyze alerts generated by IDS.
Review network device statistics and logs.
Determine the goal of the malicious traffic and identify affected infrastructure components.
Map the attack to business risks to prioritize analysis and containment.
Identify technical characteristics of the traffic:
Source IP addresses
Ports used, TTL, Packet ID, etc.
Protocols used
Targeted machines/services
Exploits used
Remote accounts logged in
Forensic Investigations:
Identify impacted machines and the modus operandi of the attack.
If a compromised computer is identified, refer to specific intrusion response procedures.
3. Containment: : Objective: Mitigate the attack’s effects on the targeted environment.
If the issue is strategic, activate a specific crisis management cell.
Disconnect the compromised area from the network.
Isolate the source of the attack by disconnecting affected computers for further investigation.
Implement acceptable mitigation controls (MFA, geo-filtering) for business-critical flows in agreement with business line managers.
Terminate unwanted connections or processes on affected machines.
Use firewall/IPS/EDR rules to block the attack.
Update IDS rules to match the malicious behavior and inform technical staff of new events.
Apply ad hoc actions for strategic issues:
Deny egress destinations in EDR, proxies, and firewalls.
Configure security controls to contain or reject connections from compromised machines.
Limit access to critical/confidential data.
Create booby-trapped documents with watermarking for proof of theft.
Notify targeted business users of required and forbidden actions.
Configure logging capabilities in verbose mode on the targeted environment and store logs on a remote secure server.
4. Eradication: : Objective: Take actions to stop the malicious behavior.
Block the Source:
Identify and block all communication channels used by the attacker at network boundaries.
If the source is an insider, involve management, HR, and legal teams.
If the source is external, involve abuse teams and law enforcement services if necessary.
Technical Remediation:
Define a remediation process, potentially validated by the incident response team.
Use remediation steps from relevant intrusion response procedures for different operating systems.
Test and Enforce:
Test the remediation process to ensure it works without damaging services.
Implement the remediation process once approved by IT and business teams.
5. Recovery: : Objective: Restore the system to normal operations.
Ensure network traffic returns to normal.
Re-allow connections to previously contained network segments.
Follow detailed authentication and infrastructure recovery steps as necessary, ensuring each step is carefully monitored and executed.
6. Lessons Learned: : Objective: Document the incident’s details, discuss lessons learned, and adjust plans and defenses.
Report:
Document the initial cause of the incident, actions taken, timelines, successes, failures, incident cost, and indicators of compromise.
Make the report available to all relevant actors.
Capitalize:
Identify actions to improve network intrusion management processes.
Reflect on preparation steps to enhance response efficiency in future incidents.
Update contact lists and note effective contact methods for each involved party.
Strengthen relationships inside and outside the organization to aid in future incidents.
Review and enhance DKIM, SPF, and DMARC filters.
Collaborate with legal teams if legal action is necessary.
Conduct a post-incident review meeting to discuss what went well, what didn’t, and how to improve future responses.</s>



**Response Type**: Incident Response
**Category**: SOAR Playbook
**Source**: agamage/incident-response-playbooks
